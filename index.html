<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>101 æ”€çˆ¬è€… | å®Œæ•´æ ¸å¿ƒç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #020617; margin: 0; overflow: hidden; font-family: 'Courier New', Courier, monospace; }
        canvas { display: block; width: 100%; height: 100vh; image-rendering: pixelated; }
    </style>
</head>
<body>
    <div id="game-container" class="relative w-full max-w-[450px] mx-auto bg-slate-900 shadow-2xl overflow-hidden">
        <div id="ui" class="absolute top-4 left-4 z-10 hidden pointer-events-none">
            <div class="bg-black/60 p-3 rounded-lg border border-teal-500/50 backdrop-blur-md">
                <div class="text-teal-400 text-sm font-bold tracking-widest">é«˜åº¦: <span id="floor">0</span>/101F</div>
                <div class="mt-2 flex items-center gap-2">
                    <div class="text-[10px] text-sky-400">STAMINA</div>
                    <div class="flex-1 w-32 bg-slate-800 h-2 rounded-full overflow-hidden">
                        <div id="stamina-bar" class="h-full bg-gradient-to-r from-sky-600 to-teal-400" style="width: 100%"></div>
                    </div>
                </div>
            </div>
        </div>

        <canvas id="gameCanvas"></canvas>

        <div id="menu" class="absolute inset-0 flex flex-col items-center justify-center bg-slate-950/90 z-20 transition-opacity">
            <div class="text-7xl mb-6">ğŸ§—</div>
            <h1 class="text-4xl font-black text-transparent bg-clip-text bg-gradient-to-b from-teal-300 to-teal-600 italic mb-2">101 CLIMBERS</h1>
            <p class="text-slate-500 text-xs mb-8 uppercase tracking-[0.2em]">Vertical Adventure Simulator</p>
            
            <div class="space-y-4 w-64 text-center">
                <button id="startBtn" class="w-full bg-teal-500 hover:bg-teal-400 text-white py-4 rounded-xl font-bold text-xl shadow-[0_0_20px_rgba(20,184,166,0.4)] transition-all transform hover:scale-105">é–‹å§‹æ”€ç™»</button>
                <div class="grid grid-cols-2 gap-2 text-[10px] text-slate-400">
                    <div class="p-2 border border-slate-800 rounded">å·¦æ‰‹æŠ“æ¡: [Z]</div>
                    <div class="p-2 border border-slate-800 rounded">å³æ‰‹æŠ“æ¡: [X]</div>
                </div>
            </div>
        </div>
    </div>

<script>
/** éŠæˆ²æ ¸å¿ƒå¸¸æ•¸ **/
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const floorText = document.getElementById('floor');
const staminaBar = document.getElementById('stamina-bar');

let gameActive = false;
let floor = 0;
let stamina = 100;
let player = { x: 200, y: 0, vy: 0, leftGrip: false, rightGrip: false };
let platforms = [];
let items = [];
let particles = [];
let wind = { power: 0, target: 0, timer: 0 };
let cameraY = 0;

/** åˆå§‹åŒ– **/
function init() {
    canvas.width = 450;
    canvas.height = window.innerHeight;
    player.y = canvas.height - 100;
    cameraY = player.y - 400;
    platforms = [];
    items = [];
    stamina = 100;
    floor = 0;
    
    // ç”Ÿæˆåˆå§‹é—œå¡
    for(let i=0; i<20; i++) {
        spawnPlatform(canvas.height - i * 150);
    }
}

function spawnPlatform(y) {
    const width = 60 + Math.random() * 40;
    platforms.push({
        x: Math.random() * (canvas.width - width),
        y: y,
        w: width,
        h: 15
    });
    // éš¨æ©Ÿç”Ÿæˆé“å…· (æ­¢æ»‘ç²‰æˆ–é³³æ¢¨)
    if(Math.random() > 0.8) {
        items.push({ x: Math.random() * 400, y: y - 30, type: Math.random() > 0.5 ? 'ğŸ¥¡' : 'ğŸ', active: true });
    }
}

/** æ§åˆ¶é‚è¼¯ **/
window.addEventListener('keydown', (e) => {
    if(e.key.toLowerCase() === 'z') player.leftGrip = true;
    if(e.key.toLowerCase() === 'x') player.rightGrip = true;
});
window.addEventListener('keyup', (e) => {
    if(e.key.toLowerCase() === 'z') player.leftGrip = false;
    if(e.key.toLowerCase() === 'x') player.rightGrip = false;
});

document.getElementById('startBtn').onclick = () => {
    init();
    gameActive = true;
    document.getElementById('menu').classList.add('hidden');
    document.getElementById('ui').classList.remove('hidden');
    update();
};

/** ç‰©ç†èˆ‡æ›´æ–° **/
function update() {
    if(!gameActive) return;

    // é¢¨åŠ›ç³»çµ±
    wind.timer--;
    if(wind.timer <= 0) {
        wind.target = (Math.random() - 0.5) * 5;
        wind.timer = 100 + Math.random() * 200;
    }
    wind.power += (wind.target - wind.power) * 0.05;

    // æ”€çˆ¬é‚è¼¯
    if(player.leftGrip || player.rightGrip) {
        player.vy = -3; // å‘ä¸Šçˆ¬
        stamina -= 0.15;
    } else {
        player.vy += 0.2; // é‡åŠ›
    }
    
    player.y += player.vy;
    player.x += wind.power; // å—é¢¨åŠ›å½±éŸ¿

    // é‚Šç•Œæª¢æŸ¥
    if(player.x < 0) player.x = 0;
    if(player.x > canvas.width - 20) player.x = canvas.width - 20;

    // é¡é ­è·Ÿéš¨
    cameraY += (player.y - cameraY - 400) * 0.1;
    floor = Math.max(floor, Math.floor((canvas.height - player.y) / 100));
    floorText.innerText = Math.min(floor, 101);

    // UI æ›´æ–°
    staminaBar.style.width = stamina + '%';
    if(stamina <= 0) endGame("åŠ›ç«­å¢œè½ï¼");
    if(floor >= 101) endGame("ç™»é ‚æˆåŠŸï¼", true);

    draw();
    requestAnimationFrame(update);
}

/** ç¹ªåœ– **/
function draw() {
    ctx.fillStyle = '#0f172a';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    ctx.save();
    ctx.translate(0, -cameraY);

    // ç•« 101 å¤§æ¨“èƒŒæ™¯ (ç°¡ç´„åƒç´ æ„Ÿ)
    ctx.fillStyle = '#1e293b';
    ctx.fillRect(100, -5000, 250, 10000);

    // ç•«é¢¨ç·š
    ctx.strokeStyle = 'rgba(255,255,255,0.2)';
    for(let i=0; i<10; i++) {
        let wx = (Math.sin(Date.now()/500 + i) * 200) + 200;
        let wy = cameraY + (i * 100);
        ctx.beginPath();
        ctx.moveTo(wx, wy);
        ctx.lineTo(wx + wind.power * 10, wy + 20);
        ctx.stroke();
    }

    // ç•«æŠ“é»/å¹³å°
    ctx.fillStyle = '#334155';
    platforms.forEach(p => {
        ctx.fillRect(p.x, p.y, p.w, p.h);
        ctx.strokeStyle = '#5eead4';
        ctx.strokeRect(p.x, p.y, p.w, p.h);
    });

    // ç•«é“å…·
    items.forEach(item => {
        if(item.active) {
            ctx.font = '20px serif';
            ctx.fillText(item.type, item.x, item.y);
            // ç°¡å–®ç¢°æ’æª¢æ¸¬
            if(Math.abs(player.x - item.x) < 30 && Math.abs(player.y - item.y) < 30) {
                item.active = false;
                stamina = Math.min(100, stamina + 20);
            }
        }
    });

    // ç•«ä¸»è§’ (è—è‰²åƒç´ æ–¹å¡Š)
    ctx.fillStyle = '#06b6d4';
    ctx.shadowBlur = 15;
    ctx.shadowColor = '#06b6d4';
    ctx.fillRect(player.x, player.y, 25, 25);
    ctx.shadowBlur = 0;

    // æ‰‹éƒ¨å‹•ä½œè¦–è¦ºåŒ–
    if(player.leftGrip) { ctx.fillStyle = '#f43f5e'; ctx.fillRect(player.x - 5, player.y, 8, 8); }
    if(player.rightGrip) { ctx.fillStyle = '#f43f5e'; ctx.fillRect(player.x + 22, player.y, 8, 8); }

    ctx.restore();
}

function endGame(msg, success = false) {
    gameActive = false;
    document.getElementById('menu').classList.remove('hidden');
    document.getElementById('startBtn').innerText = 'å†æ¬¡æŒ‘æˆ°';
    document.querySelector('h1').innerText = msg;
    if(success) createFireworks();
}

function createFireworks() {
    // ç°¡å–®çš„ç…™ç«é‚è¼¯å¯åœ¨æ­¤æ“´å……
    console.log("ğŸ† Fireworks!");
}
</script>
</body>
</html>
